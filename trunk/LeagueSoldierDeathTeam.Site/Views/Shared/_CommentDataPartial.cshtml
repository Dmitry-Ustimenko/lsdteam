@model IEnumerable<LeagueSoldierDeathTeam.BusinessLogic.Dto.CommentData>
@using LeagueSoldierDeathTeam.BusinessLogic.Classes.Enums
@using LeagueSoldierDeathTeam.BusinessLogic.Classes.Extensions
@using LeagueSoldierDeathTeam.Site.Classes
@using LeagueSoldierDeathTeam.Site.Controllers
@{
	Layout = null;
}

@if (Model.Any())
{
	foreach (var comment in Model)
	{
		<div class="comment" id="@(string.Format("comment-{0}-hash", comment.Id))">
			<div class="comment-writer">
				<div class="comment-writer-info">
					<img class="comment-writer-photo" src="@Html.Raw(!string.IsNullOrWhiteSpace(comment.Writer.PhotoPath) ? comment.Writer.PhotoPath : Constants.DefaultPhotoPath)" alt="Фото">
					<span class="comment-writer-name">@comment.Writer.UserName</span>
				</div>
				<div>
					@switch (comment.Writer.Role)
					{
						case RoleEnum.MainAdministrator:
							<img src="/Images/main-admin-banner-mini.png" alt="Баннер" />
							break;
						case RoleEnum.Administrator:
							<img src="/Images/admin-banner-mini.png" alt="Баннер" />
							break;
						case RoleEnum.Moderator:
							<img src="/Images/moderator-banner-mini.png" alt="Баннер" />
							break;
						default:
							<img src="/Images/user-banner-mini.png" alt="Баннер" />
							break;
					}
				</div>
				<div class="comment-writer-actions">
					@if (Request.IsAuthenticated && AppContext.Current.CurrentUser != null)
					{
						<a target="_blank" href="@(WebBuilder.BuildActionUrl<AccountProfileController>(m => m.CreateMessage(), new Dictionary<string, object> { { "name", comment.Writer.UserName } }))">
							<span>ЛС</span>
							<span class="private-message-icon"></span>
						</a>
					}
					<a target="_blank" href="@(WebBuilder.BuildActionUrl<AccountProfileController>(m => m.ProfileInfo(comment.Writer.Id)))">
						<span>Профиль</span>
						<span class="profile-icon"></span>
					</a>
				</div>
			</div>
			<div class="comment-description-rate">
				<div class="comment-date">
					<span class="comment-link">
						<span class="comment-link-hash">#</span>
						<input class="comment-link-input" readonly="readonly" type="text" value="@(string.Concat(Request.Url.AbsoluteUri, string.Format(" #comment-{0}", comment.Id)))" />
					</span>
					@(comment.CreateDate.TodayYesterday(Constants.BelarusTimeZone))
					@if (comment.ModifierDate.HasValue)
					{
						@(string.Format("(изменен: {0})", comment.ModifierDate.Value.TodayYesterday(Constants.BelarusTimeZone)))
					}
				</div>
				<div class="description">@comment.Description</div>
				<div class="rate">@comment.Rate</div>
			</div>
		</div>
	}
}
else
{
	<div class="no-result">Нет комментариев</div>
}
